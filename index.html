<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script>

        var D = formatDate(new Date());

        function formatDate(date) {
            var d = new Date(date),
                month = '' + (d.getMonth() + 1),
                day = '' + d.getDate(),
                year = d.getFullYear();

            if (month.length < 2)
                month = '0' + month;
            if (day.length < 2)
                day = '0' + day;

            return [day, month, year].join('-');
        }


    </script>

    
    

</head>
<body>
    <div class="container text-center">
        <div class="row">
            <h4> Covid 19 Vaccincation Centers</h4>
            <hr />
        </div>
        <div class="container">
            <div id="div1" class="row" style="padding:20px;">


            </div>
        </div>
    </div>
</body>
<script>
    ShowCenters();
    setInterval(function () {
        ShowCenters();
    }, 30000);

    function ShowCenters() {

        $.ajax({
            url: "https://cdn-api.co-vin.in/api/v2/appointment/sessions/calendarByDistrict?district_id=394&date=" + D, success: function (result) {
                console.log(result)
                $("#div1").html("");
                $.each(result.centers, function (index, value) {

                    var html = "<div class='col-sm-3'><div class='card' style='width: 18rem;'> <div class='card-body'><p>Center Name:" + value.name + "</p>";
                    html += "<p>Address:" + value.address + "</p>";
                    html += "<p>State Name:" + value.state_name + "</p>";
                    html += "<p>District Name:" + value.district_name + "</p>";
                    html += "<p>Block Name:" + value.block_name + "</p>";
                    html += "<p>PinCode:" + value.pincode + "</p>";
                    html += "<p>Fee Type:" + value.fee_type + "</p>";
                    //  html += "<p>Sessions:" + JSON.stringify(value.sessions) + "</p>";
                    available_capacity = 0;
                    $.each(value.sessions, function (index1, value1) {
                        available_capacity += value1.available_capacity


                    });
                    html += "<p>Available Capacity:" + available_capacity + "</p>";
                    html += "</div></div></div>";
                    if (available_capacity > 0)
                    $("#div1").append(html);
                    else
                    $("#div1").html("No Centers Found");

                });
            }
        });

    }
</script>
</html>
